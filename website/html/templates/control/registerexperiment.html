{% extends "control/control_base.html" %}

{% comment %}
<Program>
    control/registeranexperiment.html
<Author>
  Originally by?:
  Justin Samuel 2009

  Modified:
  Gaetano Pressimone 2012
  Eric Velazquez 2017

<Purpose>
  Django template file for the testbed clearinghouse's 'register an experiment' page.
  This help page is for logged in users only.

<Extends>
  control/control_base.html

<Stylesheet>
  common.css
  account.css

<Scripts>
  register.js

<Template Variables>
  form:
  New experiment registration form.
{% endcomment %}

    {% block title %}
    Experiment registration - {{ TESTBED }} {{ CLEARINGHOUSE }}
    {% endblock title %}

    {% block script %}
    {{ block.super }}

    {% endblock script %}

    {% block style %}
    {{ block.super }}
    <link href="{{ MEDIA_URL }}css/help.css" rel="stylesheet" type="text/css"/>
    {% endblock style %}

    {% block nav_register_expe %}
    <td class="active"><a href="{% url 'registerexperiment' %}">Register Experiment</a></td>
    {% endblock nav_register_expe %}

    {% block content %}
    <div id="main">
    {% if page_top_errors %}
        <p class="warning">
        {% for error in page_top_errors %}
            {{ error }}
            <br>
        {% endfor %}
         </p>
    {% endif %}

    <div id="middle">
    <h1>Register your experiment</h1>

        <!--TODO: create a for loop to go through all forms, following the structure of title, subtitle, items-->
        <!--TODO: Make this way more modular-->
        <!--TODO: Use CSS to apply some indentation for each part of the new experiment-->

    <h2> 1. Provide your basic information (all fields are mandatory) </h2><br>
    Any researcher who would like to perform experiments using smartphone sensors may register on the Sensibility Testbed Clearinghouse site.<br><br>
    <form action="{% url 'registerexperiment' %}" method="post">
        <!-- Token to ensure there is no CSRF attack -->
        {% csrf_token %}

        <!--Register experiment form-->
        {% for item in r_form %}
          {% if item.name != "terms_of_use" and item.name != "generate_irb_text" %}
            {{item.label_tag}} {{item}} <br>
          {% endif %}
        {% endfor %}

        <h2> 2. Provide details of your experiment </h2>

        <!--Details form-->
        {% for item in details_form %}
          {{item.label}} {{item}} <br>
        {% endfor %}

        {{details_form.sensor_details}}
        <!--End of details form-->

        <br>

        <h3>Battery</h3>

        <!--Battery form-->
        {% for item in battery_form %}
            <!--Print those vars exclusive from the battery_form-->
            {% if item.name not in sensor_var_names %}
                {{item}} {{item.label}} <br>
            {% endif %}
        {% endfor %}

        {{ battery_form.errors }}
        {{ battery_form.non_field_errors }}

        {% for item in battery_form %}
            {% if item.name in sensor_var_names and item.name != "experiment_id" and item.name != "frequency_unit" %}
                {% if "i." in item.label %}
                    <br>
                {% endif %}
                {% if item.name == "frequency" %}
                  {{item.label}} <br> {{item}} {{battery_form.frequency_unit}} <br>
                {% else %}
                  {{item.label}} <br> {{item}} <br>
                {% endif %}
            {% endif %}
        {% endfor %}
        <!--End of battery form-->

        <br>

        <h3>Bluetooth</h3>

        <!--Bluetooth form-->
        {% for item in bluetooth_form %}
            <!--Print those vars exclusive from the bluetooth_form-->
            {% if item.name not in sensor_var_names %}
                {{item}} {{item.label}} <br>
            {% endif %}
        {% endfor %}

        {% for item in bluetooth_form %}
            {% if item.name in sensor_var_names and item.name != "experiment_id" and item.name != "frequency_unit" %}
                {% if "i." in item.label %}
                    <br>
                {% endif %}
                {% if item.name == "frequency" %}
                  {{item.label}} <br> {{item}} {{battery_form.frequency_unit}} <br>
                {% else %}
                  {{item.label}} <br> {{item}} <br>
                {% endif %}
            {% endif %}
        {% endfor %}
        <!--End of bluetooth form-->

        <br>

        <h3>Cellular</h3>

        <!--Cellular form-->
        {% for item in cellular_form %}
            <!--Print those vars exclusive from the cellular_form-->
            {% if item.name not in sensor_var_names %}
                {{item}} {{item.label}} <br>
            {% endif %}
        {% endfor %}

        {% for item in cellular_form %}
            {% if item.name in sensor_var_names and item.name != "experiment_id" and item.name != "frequency_unit" %}
                {% if "i." in item.label %}
                    <br>
                {% endif %}
                {% if item.name == "frequency" %}
                  {{item.label}} <br> {{item}} {{battery_form.frequency_unit}} <br>
                {% else %}
                  {{item.label}} <br> {{item}} <br>
                {% endif %}
            {% endif %}
        {% endfor %}
        <!--End of cellular form-->

        <h3>Location</h3>

        <!--Location form-->
        {% for item in location_form %}
            <!--Print those vars exclusive from the location_form-->
            {% if item.name not in sensor_var_names %}
                {{item}} {{item.label}} <br>
            {% endif %}
        {% endfor %}

        {% for item in location_form %}
            {% if item.name in sensor_var_names and item.name != "experiment_id" and item.name != "frequency_unit" %}
                {% if "i." in item.label %}
                    <br>
                {% endif %}
                {% if item.name == "frequency" %}
                  {{item.label}} <br> {{item}} {{battery_form.frequency_unit}} <br>
                {% else %}
                  {{item.label}} <br> {{item}} <br>
                {% endif %}
            {% endif %}
        {% endfor %}
        <!--End of location form-->

        <br>

        <h3>Settings</h3>

        <!--Settings form-->
        {% for item in settings_form %}
            <!--Print those vars exclusive from the location_form-->
            {% if item.name not in sensor_var_names %}
                {{item}} {{item.label}} <br>
            {% endif %}
        {% endfor %}

        {% for item in settings_form %}
            {% if item.name in sensor_var_names and item.name != "experiment_id" and item.name != "frequency_unit" %}
                {% if "i." in item.label %}
                    <br>
                {% endif %}
                {% if item.name == "frequency" %}
                  {{item.label}} <br> {{item}} {{battery_form.frequency_unit}} <br>
                {% else %}
                  {{item.label}} <br> {{item}} <br>
                {% endif %}
            {% endif %}
        {% endfor %}
        <!--End of settings form-->

        <br>
        <h3>Sensor</h3>

        <!--Sensor form-->
        {% for item in sensor_form %}
            <!--Print those vars exclusive from the location_form-->
            {% if item.name not in sensor_var_names %}
                {{item}} {{item.label}} <br>
            {% endif %}
        {% endfor %}

        {% for item in sensor_form %}
            {% if item.name in sensor_var_names and item.name != "experiment_id" and item.name != "frequency_unit" %}
                {% if "i." in item.label %}
                    <br>
                {% endif %}
                {% if item.name == "frequency" %}
                  {{item.label}} <br> {{item}} {{battery_form.frequency_unit}} <br>
                {% else %}
                  {{item.label}} <br> {{item}} <br>
                {% endif %}
            {% endif %}
        {% endfor %}
        <!--End of sensor form-->

        <br>

        <h3>Signal Strength</h3>

        <!--Signalstrength form-->
        {% for item in signalstrength_form %}
            <!--Print those vars exclusive from the location_form-->
            {% if item.name not in sensor_var_names %}
                {{item}} {{item.label}} <br>
            {% endif %}
        {% endfor %}

        {% for item in signalstrength_form %}
            {% if item.name in sensor_var_names and item.name != "experiment_id" and item.name != "frequency_unit" %}
                {% if "i." in item.label %}
                    <br>
                {% endif %}
                {% if item.name == "frequency" %}
                  {{item.label}} <br> {{item}} {{battery_form.frequency_unit}} <br>
                {% else %}
                  {{item.label}} <br> {{item}} <br>
                {% endif %}
            {% endif %}
        {% endfor %}
        <!--End of signalstrength form-->

        <br>
        <h3>Wifi</h3>

        <!--Wifi form-->
        {% for item in wifi_form %}
            <!--Print those vars exclusive from the location_form-->
            {% if item.name not in sensor_var_names %}
                {{item}} {{item.label}} <br>
            {% endif %}
        {% endfor %}

        {% for item in wifi_form %}
            {% if item.name in sensor_var_names and item.name != "experiment_id" and item.name != "frequency_unit" %}
                {% if "i." in item.label %}
                    <br>
                {% endif %}
                {% if item.name == "frequency" %}
                  {{item.label}} <br> {{item}} {{battery_form.frequency_unit}} <br>
                {% else %}
                  {{item.label}} <br> {{item}} <br>
                {% endif %}
            {% endif %}
        {% endfor %}
        <!--End of wifi form-->

        <br>

        <h2> 3. I have read and agree to the Terms of Use for Researchers</h2>

        <br>{{r_form.terms_of_use.label_tag}} {{r_form.terms_of_use}}

        <h2> 4. Complete your IRB (Institutional Review Board) application</h2>

        <br>{{r_form.generate_irb_text.label_tag}} {{r_form.generate_irb_text}}<br><br>

        Are you waiting for IRB approval from your institution? In the interim you may experiment on the Sensibility Testbed using your own device by visiting <a href = "https://sensibilitytestbed.com/projects/project">here</a> .

        <h2> 5. My IRB approved my experiment and and I am ready to run it! </h2>
        Once we document your IRB approval letter in our database, we will email
        you your account information (username/password) as well as any other
        necessary information needed to run your experiment.<br><br><br><br>

        <input type="submit" value="Submit" />
    </form>

        {% endblock content %}